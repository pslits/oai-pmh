# Refactor: `ContainerFormat` → `Container` (include XML data)

## Summary

`ContainerFormat` in `src/Domain/ValueObject/ContainerFormat.php` is currently a design that separates the container's format from the actual XML payload. This is a design flaw: the domain needs a `Container` value object that holds the actual XML data (string) and allows derived classes to determine/populate the root tag.

## Motivation

- The current `ContainerFormat` name and responsibilities are misleading.
- We need a single immutable `Container` value object that encapsulates the XML payload (string) and provides value equality and string representation.
- Root tag handling should be the responsibility of classes deriving from or using `Container` (they decide how to wrap or parse the XML), not the value object which should only carry the data and validate basic invariants.

## Proposed change

1. Rename/refactor `ContainerFormat` → `Container`.
2. `Container` will include a single private string property for the XML data (e.g., `$xml`).
3. Constructor will validate that the XML is a non-empty string and (optionally) well-formed XML depending on the validation policy.
4. Keep the value object semantics: `final` class, immutable, `getValue()` or `getXml()`, `equals(self $other): bool`, `__toString(): string`.
5. Update any consumers/tests to use `Container` and ensure the root tag is provided by the consumer/derived classes.

## Affected files

- [src/Domain/ValueObject/ContainerFormat.php](src/Domain/ValueObject/ContainerFormat.php) — primary file to refactor.
- Tests under [tests/Domain/ValueObject/](tests/Domain/ValueObject/) that reference `ContainerFormat`.
- Any docs under `docs/` and `coverage/html/` referencing `ContainerFormat`.

## Suggested implementation tasks

- [ ] Create `src/Domain/ValueObject/Container.php` implementing the new shape and validation.
- [ ] Deprecate `ContainerFormat.php` (or convert it into a thin forwarder with an informative exception) and update references.
- [ ] Update unit tests: rename test files and assertions to use `Container`.
- [ ] Update docs and analysis files in `docs/` to reflect the new value object.
- [ ] Run `vendor/bin/phpunit` and `vendor/bin/phpstan analyse` and fix any issues.

## Acceptance criteria

- `Container` is a `final` immutable value object that stores XML data and implements `equals()` and `__toString()`.
- All tests that rely on container behavior pass after refactor.
- No business logic (root tag selection/wrapping) is moved into the value object; consumers handle it.

## Notes

If you want, I can implement the refactor (create `Container.php`, update tests and docs) and open a PR. Alternatively I can just open this issue on GitHub for you. Which would you prefer?

---

Generated by repository automation on branch: `10-define-repository-identity-value-object`.
